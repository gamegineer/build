<?xml version="1.0" encoding="UTF-8"?>
<!--
    build.xml
    Copyright 2008-2011 Gamegineer.org
    All rights reserved.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

    Created on Mar 11, 2008 at 9:50:00 PM.
-->
<project name="gamegineer" default="rebuild">

    <property environment="env" />
    <property name="builderDir" value="checkout" />

    <target name="build">
        <ant antfile="run-build.xml" dir="${builderDir}" />
    </target>

    <target name="clean">
        <echo level="info">Deleting build directory...</echo>
        <delete includeEmptyDirs="true" quiet="true">
            <fileset dir="${builderDir}" defaultexcludes="no" />
        </delete>
    </target>

    <target name="fetch">
        <path id="svn.classpath">
            <pathelement location="${env.SVNANT_HOME}/lib/svnjavahl.jar" />
            <pathelement location="${env.SVNANT_HOME}/lib/svnant.jar" />
            <pathelement location="${env.SVNANT_HOME}/lib/svnClientAdapter.jar" />
        </path>

        <typedef resource="org/tigris/subversion/svnant/svnantlib.xml" classpathref="svn.classpath" />

        <condition property="srcBranch" value="${env.GAMEGINEER_BRANCH}" else="trunk">
        	<isset property="env.GAMEGINEER_BRANCH" />
        </condition>
        <property name="baseSrcUrl" value="https://gamegineer.svn.sourceforge.net/svnroot/gamegineer/dev/${srcBranch}" />
        <echo level="info">Fetching from URL '${baseSrcUrl}'...</echo>

        <svn>
            <!-- Builder -->
            <export srcUrl="${baseSrcUrl}/org.gamegineer.builder" destPath="${builderDir}" />

            <!-- Features -->
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.feature.base" destPath="${builderDir}/features/org.gamegineer.common.feature.base" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.feature.base.tests" destPath="${builderDir}/features/org.gamegineer.common.feature.base.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.feature.ui" destPath="${builderDir}/features/org.gamegineer.common.feature.ui" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.feature.ui.tests" destPath="${builderDir}/features/org.gamegineer.common.feature.ui.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.feature.base" destPath="${builderDir}/features/org.gamegineer.table.feature.base" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.feature.base.tests" destPath="${builderDir}/features/org.gamegineer.table.feature.base.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.feature.ui" destPath="${builderDir}/features/org.gamegineer.table.feature.ui" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.feature.ui.tests" destPath="${builderDir}/features/org.gamegineer.table.feature.ui.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.test.feature.base" destPath="${builderDir}/features/org.gamegineer.test.feature.base" />

            <!-- Plugins -->
            <export srcUrl="${baseSrcUrl}/net.jcip.annotations" destPath="${builderDir}/plugins/net.jcip.annotations" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.core" destPath="${builderDir}/plugins/org.gamegineer.common.core" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.core.tests" destPath="${builderDir}/plugins/org.gamegineer.common.core.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.persistence" destPath="${builderDir}/plugins/org.gamegineer.common.persistence" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.persistence.tests" destPath="${builderDir}/plugins/org.gamegineer.common.persistence.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.ui" destPath="${builderDir}/plugins/org.gamegineer.common.ui" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.common.ui.tests" destPath="${builderDir}/plugins/org.gamegineer.common.ui.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.core" destPath="${builderDir}/plugins/org.gamegineer.table.core" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.core.persistence.serializable" destPath="${builderDir}/plugins/org.gamegineer.table.core.persistence.serializable" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.core.persistence.serializable.tests" destPath="${builderDir}/plugins/org.gamegineer.table.core.persistence.serializable.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.core.tests" destPath="${builderDir}/plugins/org.gamegineer.table.core.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.net" destPath="${builderDir}/plugins/org.gamegineer.table.net" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.net.tests" destPath="${builderDir}/plugins/org.gamegineer.table.net.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.product" destPath="${builderDir}/plugins/org.gamegineer.table.product" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.product.tests" destPath="${builderDir}/plugins/org.gamegineer.table.product.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.ui" destPath="${builderDir}/plugins/org.gamegineer.table.ui" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.table.ui.tests" destPath="${builderDir}/plugins/org.gamegineer.table.ui.tests" />
            <export srcUrl="${baseSrcUrl}/org.gamegineer.test.core" destPath="${builderDir}/plugins/org.gamegineer.test.core" />
        </svn>
    </target>

    <target name="rebuild">
		<antcall target="clean" />
		<antcall target="fetch" />
		<antcall target="build" />
    </target>

</project>
